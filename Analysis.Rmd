---
title: "Analysis"
output: html_document
---

```{r}
library(tidyverse)
library(reshape2)
library(RColorBrewer)
```


```{r}

df <- read_csv("all_nba_2022.csv")

df_numeric <- df %>% select(minutes_pg,
  fga,
  fg3a,
  fta,
  pts_per_g,
  trb_per_g,
  ast_per_g,
  stl_per_g,
  blk_per_g,
  fg_pct,
  fg3_pct,
  ft_pct
)
```

```{r}
corr_mat <- cor(df_numeric, use = "pairwise.complete.obs")

corr_df <- melt(corr_mat)

my_colors <- colorRampPalette(c("#d73027", "#fee08b", "#1a9850"))(100)


```

```{r}
ggplot(corr_df, aes(Var1, Var2, fill = value)) +
  scale_fill_gradientn(colours = my_colors, limits = c(-1,1)) +
  geom_text(aes(label = sprintf("%.2f", value)), size = 3) +
  theme_minimal(base_size = 12) + theme(
    axis.text.x = element_text(angle = 70, hjust = 1),
    axis.title = element_blank(),
    panel.grid = element_blank()
  ) +
  coord_fixed()
```

